!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).ShapeRec=n()}(this,function(){return function(){function t(t){this.scene=t}var n=t.prototype;return n.generatePoints=function(t,n){for(var e=this.scene.textures.getFrame(t,n),i=e.width,r=e.height,o=[],a=0;a<r;a++)for(var f=0;f<i;f++)this.scene.textures.getPixelAlpha(f,a,t,n)&&o.push({x:f,y:a});return o},n.test=function(t,n,e){if(!t||!n)return null;var i=0,r=0;return t.forEach(function(o,a){o.forEach(function(o,f){var h=n[a][f];if(o&&h)i++;else if(o!==h&&(r++,e)){var u=function(e,i){var r;r=t[e][i]?n:t;for(var o=0,a=-1;a<2;a++)for(var f=-1;f<2;f++){var h=e+a,u=i+f;h>=0&&h<r.length&&u>=0&&u<r[0].length&&(h!=e||u!=i)&&(o+=r[h][u]?1:0)}return o}(a,f);u&&(r--,i+=u/8)}})}),{hitsRatio:i/(i+r),hits:i,fails:r}},n.getBounds=function(t){var n={minX:1e6,minY:1e6,maxX:-1e6,maxY:-1e6,width:0,height:0};return t.forEach(function(t){t.x<n.minX?n.minX=t.x:t.x>n.maxX&&(n.maxX=t.x),t.y<n.minY?n.minY=t.y:t.y>n.maxY&&(n.maxY=t.y)}),n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n},n.makeMatrix=function(t,n,e){void 0===e&&(e=10);var i="string"==typeof t?this.generatePoints(t,n):t,r=this.getBounds(i),o=function(){for(var t=[],n=0;n<e;n++)t.push(new Array(e).fill(!1));return t}(),a=r.width>r.height?Math.floor(r.width/e):Math.floor(r.height/e);return i.forEach(function(t){var n=Math.floor((t.y-r.minY)/a),e=Math.floor((t.x-r.minX)/a);n=Math.min(n,o.length-1),e=Math.min(e,o[0].length-1),o[n][e]=!0}),o},t}()});
